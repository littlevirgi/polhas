(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[31],{"6a66":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"q-pb-xl"},[a("q-header",[a("q-toolbar",[a("q-btn",{attrs:{to:{name:"Settings"},flat:"",round:"",dense:"",icon:"arrow_back"}}),a("q-toolbar-title",[e._v("\n       Kelola Transaksi\n      ")])],1)],1),a("div",{staticClass:"q-pa-md "},[a("div",{staticClass:"row items-center q-gutter-x-sm"},[a("q-btn",{attrs:{color:"primary",icon:e.isFilter?"search":"sort",unelevated:"",readonly:""},on:{click:e.handleSelectMode}}),a("div",{staticClass:"col"},[e.isFilter?a("q-select",{staticClass:"bg-grey-3 q-px-sm",attrs:{dense:"",borderless:"",options:e.options,placeholder:"Filter Order"},on:{input:e.handleFilterOrder},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}):e._e(),e.isFilter?e._e():a("q-input",{staticClass:"bg-grey-3 q-px-sm",attrs:{placeholder:"Ketik no invoice atau whatsapp",dense:"",borderless:""},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearchOrder(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),a("div",[e.isFilter?e._e():a("q-btn",{attrs:{label:"Cari",unelevated:"",color:"primary"},on:{click:e.handleSearchOrder}})],1)],1)]),e.orders.data.length?[a("div",[a("q-list",{attrs:{separator:""}},[a("q-item",[a("q-item-section",{staticClass:"xs-hide",attrs:{side:""}},[e._v("\n         #\n        ")]),a("q-item-section",[a("q-item-label",[e._v("Detail")])],1),a("q-item-section",{attrs:{side:""}},[a("q-item-label",[e._v("Actions")])],1)],1),e._l(e.orders.data,(function(t,n){return a("q-item",{key:n},[a("q-item-section",{staticClass:"xs-hide",attrs:{side:"",top:""}},[e._v("\n          "+e._s(n+1)+"\n        ")]),a("q-item-section",{attrs:{top:""}},[a("div",{staticClass:"text-sm1"},[a("table",{staticClass:"dense"},[a("tr",[a("td",[e._v("INVOICE")]),a("td",[e._v(e._s(t.order_ref))])]),a("tr",[a("td",[e._v("Nama")]),a("td",[e._v(e._s(t.customer_name))])]),a("tr",[a("td",[e._v("WA")]),a("td",[e._v(e._s(t.customer_whatsapp))])]),a("tr",[a("td",[e._v("Total")]),a("td",[e._v(e._s(e.moneyIDR(t.order_total)))])]),a("tr",[a("td",[e._v("Dibuat")]),a("td",[e._v(e._s(t.created_at))])]),a("tr",[a("td",[e._v("Pengiriman")]),a("td",[e._v(e._s(t.shipping_courier_name))])]),a("tr",[a("td",[e._v("Pembayaran")]),a("td",[e._v(e._s(t.transaction?t.transaction.payment_name:""))])]),a("tr",[a("td",[e._v("Status")]),a("td",[a("q-badge",{attrs:{color:e.changeBadgeColor(t.order_status)}},[e._v(e._s(t.status_label))])],1)])])])]),a("q-item-section",{attrs:{side:"",top:""}},[a("div",{staticClass:"column q-gutter-y-sm"},[a("q-btn",{attrs:{unelevated:"","no-caps":"",size:"12px",label:e.messageButtonLabel(t.order_status),color:"green-7"},on:{click:function(a){return e.handleFollowUp(t)}}}),e.canConfirm(t)?a("q-btn",{attrs:{unelevated:"","no-caps":"",size:"12px",label:"Konfirmasi",color:"blue-7"},on:{click:function(a){return e.handleConfirmationOrder(t.id)}}}):e._e(),a("q-btn",{attrs:{unelevated:"","no-caps":"",size:"12px",label:"Hapus",color:"red-7"},on:{click:function(a){return e.handleDeleteOrder(t.id)}}}),a("q-btn",{attrs:{unelevated:"","no-caps":"",size:"12px",label:"Detail",color:"purple-7",to:{name:"AdminOrderShow",params:{order_ref:t.order_ref}}}}),e.canInputResi(t)?a("q-btn",{attrs:{unelevated:"","no-caps":"",size:"12px",label:"Input Resi",color:"orange"},on:{click:function(a){return e.handleInputResi(t)}}}):e._e(),e.canShip(t)?a("q-btn",{attrs:{unelevated:"","no-caps":"",size:"12px",label:"Kirim COD",color:"orange"},on:{click:function(a){return e.handleKirimCod(t)}}}):e._e(),e.canComplete(t)?a("q-btn",{attrs:{unelevated:"","no-caps":"",size:"12px",label:"Order Selesai",color:"blue-6"},on:{click:function(a){return e.handleCompletionOrder(t)}}}):e._e()],1)])],1)}))],2)],1),a("div",{staticClass:"flex justify-center q-py-xl"},[e.orders.canLoadMore&&e.isFilter?a("q-btn",{attrs:{outline:"",loading:e.orders.isLoadMore,label:"loadmore...",unelevated:"",color:"primary"},on:{click:e.loadMore}}):e._e()],1)]:[a("div",{staticClass:"text-center q-pt-xl"},[e._v("Tidak ada data")])],a("q-dialog",{model:{value:e.followUpModal,callback:function(t){e.followUpModal=t},expression:"followUpModal"}},[a("follow-up",{attrs:{order:e.currentOrder},on:{close:function(t){e.followUpModal=!1}}})],1),a("q-dialog",{model:{value:e.inputResiModal,callback:function(t){e.inputResiModal=t},expression:"inputResiModal"}},[a("q-card",{staticStyle:{width:"100%","max-width":"420px"},attrs:{square:""}},[a("div",{staticClass:"q-px-md q-py-sm bg-blue-7 text-white text-weight-bold"},[e._v("Input Resi  "),e.orderSelected?a("span",[e._v("# "+e._s(e.orderSelected.code))]):e._e()]),a("q-form",{on:{submit:function(t){return t.preventDefault(),e.submitResi(t)}}},[a("q-card-section",[a("q-input",{staticClass:"text-sm",attrs:{filled:"",square:"",label:"No Resi",rules:[function(e){return e&&e.length>0||"Wajib diisi"}]},model:{value:e.form.resi,callback:function(t){e.$set(e.form,"resi",t)},expression:"form.resi"}})],1),a("q-card-actions",{staticClass:"justify-end"},[a("q-btn",{attrs:{flat:"",label:"Batal",color:"primary"},on:{click:function(t){return t.preventDefault(),e.closeModal(t)}}}),a("q-btn",{attrs:{unelevated:"",type:"submit",label:"Simpan",color:"primary"}})],1)],1)],1)],1),a("q-inner-loading",{attrs:{showing:e.loading}},[a("q-spinner-facebook",{attrs:{size:"50px",color:"primary"}})],1)],2)},r=[],s=a("ded3"),i=a.n(s),o=(a("4de4"),a("ac1f"),a("841c"),a("2f62")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card",{staticStyle:{width:"100%","max-width":"400px"}},[a("q-form",{on:{submit:function(t){return t.preventDefault(),e.submitMessage(t)}}},[a("div",{staticClass:"q-px-md q-pt-md q-pb-sm"},[a("div",{staticClass:"text-h6"},[e._v(e._s(e.messageButtonLabel))]),a("div",{staticClass:"text-xs text-grey-7"},[e._v("Anda bisa mengedit dengan format pesan anda sendiri.")])]),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"80vh"}},[a("q-input",{staticClass:"textarea-input",attrs:{outlined:"",type:"textarea",rows:"18"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{type:"button",label:"Batal","no-caps":"",unelevated:""},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}}),a("q-btn",{attrs:{unelevated:"",type:"submit",label:"Kirim Whatsapp",color:"primary","no-caps":""}})],1)],1)],1)},c=[],d=(a("99af"),a("5319"),a("2ca0"),a("159b"),a("b0c0"),{props:["order"],data:function(){return{message:""}},computed:{shop:function(){return this.$store.state.shop},banks:function(){return this.$store.state.bank.banks},messageButtonLabel:function(){return"UNPAID"==this.order.order_status||"OVERDUE"==this.order.order_status?"Follow Up Order":"Send Message"}},methods:{submitMessage:function(){var e="https://api.whatsapp.com/send?phone=".concat(this.formatPhoneNumber(this.order.customer_whatsapp),"&text=").concat(encodeURI(this.message));window.open(e,"_blank")},money:function(e){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e)},formatPhoneNumber:function(e){var t=e.replace(/\D/g,"");return t.startsWith("0")&&(t="62"+t.substr(1)),t},getRoutePath:function(){var e=this.$router.resolve({name:"UserInvoice",params:{order_ref:this.order.order_ref}});return location.origin+e.href},setPaymentMessage:function(){var e="Silahkan lakukan pembayaran ke nomor rekening berikut:\n\n";return this.banks.data.length?(this.banks.data.forEach((function(t){e+="*".concat(t.bank_name," - ").concat(t.bank_office,"*\nNorek: ").concat(t.account_number,"\nA.n ").concat(t.account_name,"\n\n")})),e):""},setTextMessage:function(){if(this.order)if("UNPAID"==this.order.order_status){var e="Halo kak ".concat(this.order.customer_name,"\nkami dari *").concat(this.shop.name?this.shop.name:"...","*\nberikut adalah pesanan kakak pada toko kami:\n\nInvoice : *").concat(this.order.order_ref,"*\ndi pesan pada : ").concat(this.order.created_at,"\nSubtotal : ").concat(this.moneyIDR(this.order.order_subtotal),"\nOngkos Kirim : ").concat(this.moneyIDR(this.order.shipping_cost),"\nKode Unik : - ").concat(this.order.order_unique_code,"\n*Total : ").concat(this.moneyIDR(this.order.order_total),"*\n\n").concat(this.setPaymentMessage(),"\nUntuk detail tagihan dapat dilihat di ").concat(this.getRoutePath(),"\n\nTerima Kasih\n           ");this.message=e}else{var t="Halo kak ".concat(this.order.customer_name,"\nkami dari ").concat(this.shop.name?this.shop.name:"...","\n\n......\n\nTerima Kasih\n           ");this.message=t}}},mounted:function(){this.setTextMessage()}}),u=d,m=a("2877"),p=a("f09f"),h=a("0378"),f=a("a370"),b=a("27f9"),_=a("4b7e"),g=a("9c40"),v=a("eebe"),k=a.n(v),q=Object(m["a"])(u,l,c,!1,null,null,null),O=q.exports;k()(q,"components",{QCard:p["a"],QForm:h["a"],QCardSection:f["a"],QInput:b["a"],QCardActions:_["a"],QBtn:g["a"]});var C={name:"OrderIndex",components:{FollowUp:O},data:function(){return{isFilter:!0,options:["ALL","UNPAID","PAID","PROCESS","SHIPPING","COMPLETE","CANCELED"],inputResiModal:!1,orderSelected:"",followUpModal:!1,currentOrder:null,search:"",filter:"ALL",form:{order_id:"",resi:"",status:""}}},computed:i()({},Object(o["e"])({orders:function(e){return e.order.orders},loading:function(e){return e.loading}})),created:function(){this.getOrders()},methods:i()(i()({},Object(o["b"])("order",["getOrders","getPaginateOrder","getPaginateFilterOrder","destroyOrder","acceptPayment","inputResi","updateStatusOrder","searchOrder","filterOrder"])),{},{loadMore:function(){this.getPaginateOrder({filter:this.filter,skip:this.orders.data.length})},handleSelectMode:function(e){this.isFilter=!this.isFilter,this.search="",this.filter=""},handleKirimCod:function(e){var t=this;this.$q.dialog({title:"Konfirmasi",message:'Akan mengirim pesanan sekarang?, ini akan merubah status pesanan menjadi "sedang dikirim"',cancel:!0}).onOk((function(){t.form.status="SHIPPING",t.form.order_id=e.id,t.updateStatusOrder(t.form)}))},canShip:function(e){return"COD"==e.shipping_courier_name&&("PROCESS"==e.order_status||"UNPAID"==e.order_status)},canComplete:function(e){return"SHIPPING"==e.order_status},handleCompletionOrder:function(e){var t=this;this.form.status="COMPLETE",this.form.order_id=e.id,this.$q.dialog({title:"Konfirmasi",message:'Ini akan merubah status pesanan menjadi "selesai"',cancel:!0}).onOk((function(){t.updateStatusOrder(t.form)}))},handleSearchOrder:function(){this.$store.commit("SET_LOADING",!0),this.searchOrder(this.search)},handleFilterOrder:function(){this.filterOrder(this.filter)},resetOrder:function(){this.orderFiltered=[],this.isFilter=!1,this.search="",this.filter=""},changeBadgeColor:function(e){return"PAID"==e||"SHIPPING"==e?"teal":"PROCESS"==e?"blue-7":"COMPLETE"==e?"green-6":"UNPAID"==e?"grey-6":"grey-7"},canConfirm:function(e){return"COD"!=e.shipping_courier_name&&("UNPAID"==e.order_status||"OVERDUE"==e.order_status)},canInputResi:function(e){return"COD"!=e.shipping_courier_name&&("PROCESS"==e.order_status||"PAID"==e.order_status)},messageButtonLabel:function(e){return"UNPAID"==e||"OVERDUE"==e?"Follow Up Order":"Kirim Pesan"},money:function(e){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e)},handleDeleteOrder:function(e){var t=this;this.$q.dialog({title:"Yakin akan menghapus data?",message:"data yang dihapus tidak dapat dikembalikan.",ok:{label:"Hapus",flat:!0,"no-caps":!0,color:"red-7"},cancel:{label:"Batal",flat:!0,"no-caps":!0}}).onOk((function(){t.destroyOrder(e)})).onCancel((function(){})).onDismiss((function(){}))},handleConfirmationOrder:function(e){var t=this;this.$q.dialog({title:"Konfirmasi pembayaran",message:"Pastikan pembayaran telah anda terima dengan baik",ok:{label:"Konfirmasi",flat:!0,"no-caps":!0,color:"green-7"},cancel:{label:"Batal",flat:!0,"no-caps":!0}}).onOk((function(){t.acceptPayment(e)})).onCancel((function(){})).onDismiss((function(){}))},handleFollowUp:function(e){this.currentOrder=e,this.followUpModal=!0},handleInputResi:function(e){this.form.resi="",this.orderSelected=e,this.form.order_id=e.id,this.inputResiModal=!0},closeModal:function(){this.inputResiModal=!1,this.orderSelected="",this.form.order_id=""},submitResi:function(){this.inputResi(this.form),this.closeModal()}})},y=C,x=a("9989"),I=a("e359"),S=a("65c6"),P=a("6ac5"),D=a("ddd8"),w=a("1c1c"),R=a("66e5"),M=a("4074"),Q=a("0170"),U=a("58a81"),E=a("24e8"),F=a("74f7"),A=a("e669"),N=Object(m["a"])(y,n,r,!1,null,null,null);t["default"]=N.exports;k()(N,"components",{QPage:x["a"],QHeader:I["a"],QToolbar:S["a"],QBtn:g["a"],QToolbarTitle:P["a"],QSelect:D["a"],QInput:b["a"],QList:w["a"],QItem:R["a"],QItemSection:M["a"],QItemLabel:Q["a"],QBadge:U["a"],QDialog:E["a"],QCard:p["a"],QForm:h["a"],QCardSection:f["a"],QCardActions:_["a"],QInnerLoading:F["a"],QSpinnerFacebook:A["a"]})}}]);